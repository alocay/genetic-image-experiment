<html>
    <head>
        <script src="jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="styles.css">
        <script type="text/javascript" src="bundle.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                const genDiv = $("#gen");
                const polyDiv = $("#poly");
                const scoreDiv = $("#score");
                const runButton = $("#genp");
                const goalCtx = $("#goal")[0].getContext("2d");
                const workingCtx = $("#working")[0].getContext("2d");
                const fittestCtx = $("#fittest")[0].getContext("2d");
                const imggoal = document.getElementById("bear");
                
                let count = 1;
                let running = false;
                
                function createGoalPoly() {
                    goalCtx.fillStyle = '#ff0000';
                    goalCtx.beginPath();
                    
                    goalCtx.moveTo(5, 15);
                    goalCtx.lineTo(60, 30);
                    goalCtx.lineTo(60, 90);
                    goalCtx.lineTo(10, 90);
                    
                    goalCtx.closePath();
                    goalCtx.fill();
                    
                    goalCtx.fillStyle = '#00ff00bb';
                    goalCtx.beginPath();
                    
                    goalCtx.moveTo(15, 15);
                    goalCtx.lineTo(90, 50);
                    goalCtx.lineTo(30, 75);
                    
                    goalCtx.closePath();
                    goalCtx.fill();
                }
                
                function createGoalImage() {
                    goalCtx.drawImage(imggoal, 0, 0);
                }
                
                const genalgo = GenAlgo.NewGenAlgo(120, 120, workingCtx, fittestCtx);
                
                function runAlgoStep() {
                    if (genalgo.isRunning()) {
                        const stats = genalgo.runOnce(goalCtx);
                        genDiv.text("Gen: " + genalgo.getCurrentGeneration());
                        polyDiv.text("Polys: " + stats[0]);
                        scoreDiv.text("Delta: " + stats[1]);
                    }
                    
                    window.requestAnimationFrame(runAlgoStep);
                }
                
                createGoalImage();                
                window.requestAnimationFrame(runAlgoStep);
                genDiv.text("Gen: " + genalgo.getCurrentGeneration());
            });
        </script>
    </head>
	<body>
        <div>
            <div style="display:inline-block; width:120px;">Goal</div>
            <div style="display:inline-block; width:120px;">Best (so far)</div>
        </div>
		<canvas id="goal" width="120" height="120" style="border:1px solid #000000;"></canvas>
        <canvas id="fittest" width="120" height="120" style="border:1px solid #000000;"></canvas>
		<canvas id="working" width="120" height="120" style="border:1px solid #000000;display: none;"></canvas>
        <img id="bear" src="fuzzy_sm.jpg" />
		<div id="gen">Gen: </div>
        <div id="poly">Polys: </div>
        <div id="score">Delta: </div>
	</body>
</html>